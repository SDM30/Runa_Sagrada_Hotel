<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8" />
    <meta name="description" content="Runa Sagrada - Panel de Administración" />
    <meta name="keywords" content="staff, dashboard, gestión, habitaciones" />
    <meta name="author" content="Runa Sagrada" />
    <title>Gestión de Habitaciones - Runa Sagrada</title>
    <link rel="preload" th:href="@{/images/logito.png}" as="image" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
    />
    <link rel="stylesheet" th:href="@{/styles/styles.css}" />
    <link rel="stylesheet" th:href="@{/styles/styles1.css}" />
  </head>
  <body class="dashboard-container">
    <button
      class="sidebar-toggle d-lg-none"
      type="button"
      id="sidebarToggle"
      aria-controls="sidebar"
      aria-expanded="false"
      aria-label="Alternar navegación"
    >
      <i class="fas fa-bars"></i>
    </button>
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <img
          th:src="@{/images/logito.png}"
          alt="Runa Sagrada"
          class="sidebar-logo"
        />
        <h2 class="sidebar-title">Staff Panel</h2>
      </div>
      <nav
        class="sidebar-nav nav flex-column"
        id="sidebarTab"
        role="tablist"
        aria-orientation="vertical"
      >
        <a class="sidebar-nav-link" th:href="@{/dashboard}" role="tab">
          <span>Dashboard</span>
        </a>
        <a class="sidebar-nav-link" th:href="@{/hotel/staff}" role="tab">
          <span>Gestión Hoteles</span>
        </a>
        <a class="sidebar-nav-link active" th:href="@{/rooms/staff}" role="tab">
          <span>Gestión Habitaciones</span>
        </a>
        <a class="sidebar-nav-link" th:href="@{/service/staff}" role="tab">
          <span>Gestión Servicios</span>
        </a>
        <a class="sidebar-nav-link" th:href="@{/finance/staff}" role="tab">
          <span>Finanzas</span>
        </a>
        <a class="sidebar-nav-link" th:href="@{/report/staff}" role="tab">
          <span>Reportes</span>
        </a>
        <a
          class="sidebar-nav-link text-white bg-danger rounded-pill mt-3 text-center"
          th:href="@{/}"
          role="tab"
        >
          <span>Volver al sitio</span>
        </a>
      </nav>
    </aside>

    <header class="dashboard-header">
      <h1 class="dashboard-title">Gestión de Habitaciones</h1>
      <p class="dashboard-subtitle">
        Administra los tipos de habitaciones y las habitaciones individuales
      </p>
    </header>

    <div class="container-fluid px-4">
      <ul class="nav nav-tabs nav-fill mb-4" id="roomTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="room-types-tab"
            data-bs-toggle="tab"
            data-bs-target="#room-types"
            type="button"
            role="tab"
            aria-controls="room-types"
            aria-selected="true"
          >
            <i class="fas fa-bed me-2"></i>Tipos de Habitación
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="rooms-tab"
            data-bs-toggle="tab"
            data-bs-target="#rooms"
            type="button"
            role="tab"
            aria-controls="rooms"
            aria-selected="false"
          >
            <i class="fas fa-door-open me-2"></i>Gestión Habitaciones
          </button>
        </li>
      </ul>
    </div>

    <main class="main-content">
      <div class="tab-content" id="roomTabContent">
        <div
          class="tab-pane fade show active"
          id="room-types"
          role="tabpanel"
          aria-labelledby="room-types-tab"
        >
          <section class="tabla-section">
            <div class="tabla-header">
              <h2 class="tabla-title">Tipos de Habitación Registrados</h2>
              <div class="tabla-actions">
                <button
                  class="btn btn-gradient"
                  data-bs-toggle="modal"
                  data-bs-target="#modalCRoomType"
                >
                  <i class="fas fa-plus me-2"></i>Agregar Nuevo Tipo
                </button>
                <a th:href="@{/rooms/staff}" class="btn btn-outline-light">
                  <i class="fas fa-sync-alt me-2"></i>Actualizar
                </a>
              </div>
            </div>

            <form
              id="search-form-types"
              th:action="@{/roomtype/staff/search}"
              method="post"
              class="row g-2 mb-3"
            >
              <div class="col">
                <input
                  type="text"
                  name="name"
                  class="form-control"
                  placeholder="Nombre de tipo de habitación"
                />
              </div>
              <div class="col">
                <input
                  type="number"
                  name="minCapacity"
                  class="form-control"
                  placeholder="Capacidad mínima"
                />
              </div>
              <div class="col">
                <input
                  type="number"
                  name="maxCapacity"
                  class="form-control"
                  placeholder="Capacidad máxima"
                />
              </div>
              <div class="col-auto">
                <button type="submit" class="btn btn-primary">Buscar</button>
              </div>
            </form>

            <div
              th:if="${successMessage}"
              class="alert alert-success alert-dismissible fade show"
              role="alert"
            >
              <span th:text="${successMessage}"></span>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="alert"
              ></button>
            </div>
            <div
              th:if="${errorMessage}"
              class="alert alert-danger alert-dismissible fade show"
              role="alert"
            >
              <span th:text="${errorMessage}"></span>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="alert"
              ></button>
            </div>

            <div class="table-responsive">
              <table
                class="table table-dark table-striped table-hover"
                th:if="${roomTypes != null and not #lists.isEmpty(roomTypes)}"
              >
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Capacidad</th>
                    <th>Precio Base</th>
                    <th>Descripción</th>
                    <th>Acciones</th>
                  </tr>
                </thead>
                <tbody>
                  <tr th:each="roomType : ${roomTypes}">
                    <td th:text="${roomType.id}"></td>
                    <td th:text="${roomType.name}"></td>
                    <td th:text="${roomType.capacity}"></td>
                    <td
                      th:text="${'$' + #numbers.formatDecimal(roomType.basePrice, 1, 'COMMA', 2, 'POINT')}"
                    ></td>
                    <td>
                      <span
                        th:if="${roomType.description != null and roomType.description.length() > 50}"
                        th:attr="data-bs-title=${roomType.description}"
                        data-bs-toggle="tooltip"
                        th:text="${#strings.substring(roomType.description, 0, 50) + '...'}"
                      ></span>
                      <span
                        th:unless="${roomType.description != null and roomType.description.length() > 50}"
                        th:text="${roomType.description != null ? roomType.description : 'Sin descripción'}"
                      ></span>
                    </td>
                    <td>
                      <button
                        class="btn btn-sm btn-primary me-1"
                        data-bs-toggle="modal"
                        data-bs-target="#modalURoomType"
                        th:data-roomtype-id="${roomType.id}"
                        th:data-roomtype-name="${roomType.name}"
                        th:data-roomtype-capacity="${roomType.capacity}"
                        th:data-roomtype-baseprice="${roomType.basePrice}"
                        th:data-roomtype-description="${roomType.description}"
                        onclick="loadRoomTypeData(this)"
                      >
                        <i class="fas fa-edit"></i> Editar
                      </button>
                      <a
                        class="btn btn-sm btn-danger"
                        th:href="@{/roomtype/staff/delete/{id}(id=${roomType.id})}"
                        onclick="return confirm('¿Estás seguro de que quieres eliminar este tipo de habitación?')"
                      >
                        <i class="fas fa-trash"></i>
                      </a>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div
              th:if="${roomTypes == null or #lists.isEmpty(roomTypes)}"
              class="text-center py-4"
            >
              <i class="fas fa-bed fa-3x text-muted mb-3"></i>
              <h4 class="text-muted">No se encontraron tipos de habitación</h4>
              <p class="text-muted">
                Agrega un nuevo tipo de habitación para comenzar
              </p>
            </div>
          </section>
        </div>

        <div
          class="tab-pane fade"
          id="rooms"
          role="tabpanel"
          aria-labelledby="rooms-tab"
        >
          <section class="tabla-section">
            <div class="tabla-header">
              <h2 class="tabla-title">Habitaciones Registradas</h2>
              <div class="tabla-actions">
                <button
                  class="btn btn-gradient"
                  data-bs-toggle="modal"
                  data-bs-target="#modalCRoom"
                >
                  <i class="fas fa-plus me-2"></i>Agregar Nueva
                </button>
                <a th:href="@{/rooms/staff}" class="btn btn-outline-light">
                  <i class="fas fa-sync-alt me-2"></i>Actualizar
                </a>
              </div>
            </div>

            <form
              id="search-form"
              th:action="@{/rooms/staff/search}"
              method="post"
              class="row g-2 mb-3"
            >
              <div class="col-md-2">
                <input
                  type="text"
                  class="form-control"
                  name="roomNumber"
                  placeholder="Número"
                />
              </div>
              <div class="col-md-2">
                <input
                  type="number"
                  class="form-control"
                  name="floorNumber"
                  placeholder="Piso"
                />
              </div>
              <div class="col-md-2">
                <select class="form-select" name="resStatus">
                  <option value="">Estado Reserva</option>
                  <option
                    th:each="status : ${reservationStatuses}"
                    th:value="${status}"
                    th:text="${status}"
                  ></option>
                </select>
              </div>
              <div class="col-md-2">
                <select class="form-select" name="cleStatus">
                  <option value="">Estado Limpieza</option>
                  <option
                    th:each="status : ${cleaningStatuses}"
                    th:value="${status}"
                    th:text="${status}"
                  ></option>
                </select>
              </div>
              <div class="col-md-2">
                <input
                  type="text"
                  class="form-control"
                  name="themeName"
                  placeholder="Tema"
                />
              </div>
              <div class="col-md-2">
                <button type="submit" class="btn btn-primary w-100">
                  <i class="fas fa-search me-1"></i>Buscar
                </button>
              </div>
            </form>

            <div class="table-responsive">
              <table
                class="table table-dark table-striped table-hover"
                th:if="${rooms != null and not #lists.isEmpty(rooms)}"
              >
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Hotel</th>
                    <th>Tipo</th>
                    <th>Número</th>
                    <th>Piso</th>
                    <th>Estado Reserva</th>
                    <th>Estado Limpieza</th>
                    <th>Tema</th>
                    <th>Acciones</th>
                  </tr>
                </thead>
                <tbody>
                  <tr th:each="room : ${rooms}">
                    <td th:text="${room.id}"></td>
                    <td th:text="${room.hotelId}"></td>
                    <td
                      th:text="${room.roomType != null ? room.roomType.name : 'N/A'}"
                    ></td>
                    <td th:text="${room.roomNumber}"></td>
                    <td th:text="${room.floorNumber}"></td>
                    <td>
                      <span
                        class="badge"
                        th:classappend="${room.resStatus.name() == 'AVAILABLE' ? 'bg-success' : (room.resStatus.name() == 'BOOKED' or room.resStatus.name() == 'OCCUPIED' ? 'bg-warning' : 'bg-secondary')}"
                        th:text="${room.resStatus}"
                      ></span>
                    </td>
                    <td>
                      <span
                        class="badge"
                        th:classappend="${room.cleStatus.name() == 'CLEAN' ? 'bg-success' : room.cleStatus.name() == 'DIRTY' ? 'bg-danger' : 'bg-warning'}"
                        th:text="${room.cleStatus}"
                      ></span>
                    </td>
                    <td th:text="${room.themeName}"></td>
                    <td>
                      <button
                        class="btn btn-sm btn-warning me-1"
                        th:onclick="|editRoom(${room.id})|"
                        data-bs-toggle="modal"
                        data-bs-target="#modalERoom"
                      >
                        <i class="fas fa-edit"></i>
                      </button>
                      <a
                        class="btn btn-sm btn-danger"
                        th:href="@{/rooms/staff/delete/{id}(id=${room.id})}"
                        onclick="return confirm('¿Estás seguro de que quieres eliminar esta habitación?')"
                      >
                        <i class="fas fa-trash"></i>
                      </a>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div th:if="${#lists.isEmpty(rooms)}" class="text-center py-4">
              <i class="fas fa-door-open fa-3x text-muted mb-3"></i>
              <h4 class="text-muted">No se encontraron habitaciones</h4>
              <p class="text-muted" th:if="${searchPerformed == null}">
                Agrega una nueva habitación para comenzar.
              </p>
              <p class="text-muted" th:if="${searchPerformed}">
                Ninguna habitación coincide con los criterios de búsqueda.
              </p>
            </div>
          </section>
        </div>
      </div>
    </main>

    <!-- Modal Crear Tipo de Habitación -->
    <div class="modal fade" id="modalCRoomType" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content bg-dark">
          <div class="modal-header">
            <h5 class="modal-title text-white">
              Agregar Nuevo Tipo de Habitación
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <form
            th:action="@{/roomtype/staff/add}"
            method="post"
            th:object="${newroomtype}"
          >
            <div class="modal-body">
              <div class="mb-3">
                <label class="form-label text-white">Nombre</label>
                <input
                  type="text"
                  class="form-control"
                  th:field="*{name}"
                  required
                />
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label text-white">Capacidad</label>
                    <input
                      type="number"
                      class="form-control"
                      th:field="*{capacity}"
                      required
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label text-white">Precio Base</label>
                    <input
                      type="number"
                      step="0.01"
                      class="form-control"
                      th:field="*{basePrice}"
                      required
                    />
                  </div>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label text-white">Descripción</label>
                <textarea
                  class="form-control"
                  rows="3"
                  th:field="*{description}"
                ></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Cerrar
              </button>
              <button type="submit" class="btn btn-primary">
                Guardar Tipo de Habitación
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Modal Actualizar Tipo de Habitación -->
    <div class="modal fade" id="modalURoomType" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content bg-dark">
          <div class="modal-header">
            <h5 class="modal-title text-white">
              Actualizar Tipo de Habitación
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <form
            id="formURoomType"
            th:action="@{/roomtype/staff/update}"
            method="post"
            th:object="${newroomtype}"
          >
            <input type="hidden" id="idUpdate" th:field="*{id}" />
            <div class="modal-body">
              <div class="mb-3">
                <label class="form-label text-white">Nombre</label>
                <input
                  type="text"
                  class="form-control"
                  id="nameUpdate"
                  th:field="*{name}"
                  required
                />
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label text-white">Capacidad</label>
                    <input
                      type="number"
                      class="form-control"
                      id="capacityUpdate"
                      th:field="*{capacity}"
                      required
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label text-white">Precio Base</label>
                    <input
                      type="number"
                      step="0.01"
                      class="form-control"
                      id="basePriceUpdate"
                      th:field="*{basePrice}"
                      required
                    />
                  </div>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label text-white">Descripción</label>
                <textarea
                  class="form-control"
                  rows="3"
                  id="descriptionUpdate"
                  th:field="*{description}"
                ></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Cerrar
              </button>
              <button type="submit" class="btn btn-primary">
                Actualizar Tipo de Habitación
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Modal Crear Habitación -->
    <div class="modal fade" id="modalCRoom" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content bg-dark">
          <div class="modal-header">
            <h5 class="modal-title text-white">Agregar Nueva Habitación</h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <form
            th:action="@{/rooms/staff/add}"
            method="post"
            th:object="${newroom}"
          >
            <div class="modal-body">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label text-white">Hotel ID</label>
                  <input
                    type="number"
                    class="form-control"
                    th:field="*{hotelId}"
                    required
                  />
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label text-white"
                    >Tipo de Habitación</label
                  >
                  <select class="form-select" name="roomType" required>
                    <option value="">Seleccionar tipo</option>
                    <option
                      th:each="type : ${roomTypes}"
                      th:value="${type.id}"
                      th:text="${type.name}"
                    ></option>
                  </select>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label text-white"
                    >Número de Habitación</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    th:field="*{roomNumber}"
                    required
                  />
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label text-white">Piso</label>
                  <input
                    type="number"
                    class="form-control"
                    th:field="*{floorNumber}"
                    required
                  />
                </div>
              </div>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label text-white">Estado Reserva</label>
                  <select class="form-select" th:field="*{resStatus}" required>
                    <option
                      th:each="status : ${reservationStatuses}"
                      th:value="${status}"
                      th:text="${status}"
                    ></option>
                  </select>
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label text-white">Estado Limpieza</label>
                  <select class="form-select" th:field="*{cleStatus}" required>
                    <option
                      th:each="status : ${cleaningStatuses}"
                      th:value="${status}"
                      th:text="${status}"
                    ></option>
                  </select>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label text-white">Tema</label>
                <input
                  type="text"
                  class="form-control"
                  th:field="*{themeName}"
                />
              </div>
              <div class="mb-3">
                <label class="form-label text-white"
                  >Descripción del Tema</label
                >
                <textarea
                  class="form-control"
                  rows="2"
                  th:field="*{themeDescription}"
                ></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Cerrar
              </button>
              <button type="submit" class="btn btn-primary">
                Guardar Habitación
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Modal Editar Habitación -->
    <div class="modal fade" id="modalERoom" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content bg-dark">
          <div class="modal-header">
            <h5 class="modal-title text-white">Editar Habitación</h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <form
            id="formERoom"
            th:action="@{/rooms/staff/update}"
            method="post"
            th:object="${newroom}"
          >
            <input type="hidden" id="roomId" th:field="*{id}" />
            <div class="modal-body">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label text-white">Hotel ID</label>
                  <input
                    type="number"
                    class="form-control"
                    id="hotelIdEdit"
                    th:field="*{hotelId}"
                    required
                  />
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label text-white"
                    >Tipo de Habitación</label
                  >
                  <select
                    class="form-select"
                    id="roomTypeIdEdit"
                    name="roomType"
                    required
                  >
                    <option value="">Seleccionar tipo</option>
                    <option
                      th:each="type : ${roomTypes}"
                      th:value="${type.id}"
                      th:text="${type.name}"
                    ></option>
                  </select>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label text-white"
                    >Número de Habitación</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="roomNumberEdit"
                    th:field="*{roomNumber}"
                    required
                  />
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label text-white">Piso</label>
                  <input
                    type="number"
                    class="form-control"
                    id="floorNumberEdit"
                    th:field="*{floorNumber}"
                    required
                  />
                </div>
              </div>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label text-white">Estado Reserva</label>
                  <select
                    class="form-select"
                    id="resStatusEdit"
                    th:field="*{resStatus}"
                    required
                  >
                    <option
                      th:each="status : ${reservationStatuses}"
                      th:value="${status}"
                      th:text="${status}"
                    ></option>
                  </select>
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label text-white">Estado Limpieza</label>
                  <select
                    class="form-select"
                    id="cleStatusEdit"
                    th:field="*{cleStatus}"
                    required
                  >
                    <option
                      th:each="status : ${cleaningStatuses}"
                      th:value="${status}"
                      th:text="${status}"
                    ></option>
                  </select>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label text-white">Tema</label>
                <input
                  type="text"
                  class="form-control"
                  id="themeNameEdit"
                  th:field="*{themeName}"
                />
              </div>
              <div class="mb-3">
                <label class="form-label text-white"
                  >Descripción del Tema</label
                >
                <textarea
                  class="form-control"
                  rows="2"
                  id="themeDescriptionEdit"
                  th:field="*{themeDescription}"
                ></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Cerrar
              </button>
              <button type="submit" class="btn btn-primary">
                Actualizar Habitación
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Sidebar toggle
        const sidebarToggle = document.getElementById("sidebarToggle");
        const sidebar = document.getElementById("sidebar");
        if (sidebarToggle) {
          sidebarToggle.addEventListener("click", () => {
            sidebar.classList.toggle("active");
          });
        }

        // Tooltip initialization
        const tooltipTriggerList = [].slice.call(
          document.querySelectorAll('[data-bs-toggle="tooltip"]')
        );
        tooltipTriggerList.map(function (tooltipTriggerEl) {
          return new bootstrap.Tooltip(tooltipTriggerEl);
        });

        // Tab persistence
        const roomTabs = document.querySelectorAll(
          '#roomTabs button[data-bs-toggle="tab"]'
        );
        roomTabs.forEach((tab) => {
          tab.addEventListener("shown.bs.tab", (event) => {
            localStorage.setItem("activeRoomTab", event.target.id);
          });
        });

        const activeTabId = localStorage.getItem("activeRoomTab");
        if (activeTabId) {
          const activeTab = document.getElementById(activeTabId);
          if (activeTab) {
            new bootstrap.Tab(activeTab).show();
          }
        }
      });

      function loadRoomTypeData(button) {
        const id = button.getAttribute("data-roomtype-id");
        const name = button.getAttribute("data-roomtype-name");
        const capacity = button.getAttribute("data-roomtype-capacity");
        const basePrice = button.getAttribute("data-roomtype-baseprice");
        const description = button.getAttribute("data-roomtype-description");

        const form = document.getElementById("formURoomType");
        form.querySelector("#idUpdate").value = id;
        form.querySelector("#nameUpdate").value = name;
        form.querySelector("#capacityUpdate").value = capacity;
        form.querySelector("#basePriceUpdate").value = basePrice;
        form.querySelector("#descriptionUpdate").value = description;
      }

      async function editRoom(id) {
        try {
          const response = await fetch(`/rooms/staff/update/${id}`);
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          const room = await response.json();

          const form = document.getElementById("formERoom");
          form.querySelector("#roomId").value = room.id;
          form.querySelector("#hotelIdEdit").value = room.hotelId;
          form.querySelector("#roomTypeIdEdit").value = room.roomType
            ? room.roomType.id
            : "";
          form.querySelector("#roomNumberEdit").value = room.roomNumber;
          form.querySelector("#floorNumberEdit").value = room.floorNumber;
          form.querySelector("#resStatusEdit").value = room.resStatus;
          form.querySelector("#cleStatusEdit").value = room.cleStatus;
          form.querySelector("#themeNameEdit").value = room.themeName;
          form.querySelector("#themeDescriptionEdit").value =
            room.themeDescription;
        } catch (error) {
          console.error("Error loading room for editing:", error);
          alert("No se pudo cargar la información de la habitación.");
        }
      }
    </script>
  </body>
</html>
